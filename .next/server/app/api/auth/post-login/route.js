"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/post-login/route";
exports.ids = ["app/api/auth/post-login/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fpost-login%2Froute&page=%2Fapi%2Fauth%2Fpost-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fpost-login%2Froute.ts&appDir=J%3A%5Cnino360%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=J%3A%5Cnino360&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fpost-login%2Froute&page=%2Fapi%2Fauth%2Fpost-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fpost-login%2Froute.ts&appDir=J%3A%5Cnino360%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=J%3A%5Cnino360&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var J_nino360_app_api_auth_post_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/post-login/route.ts */ \"(rsc)/./app/api/auth/post-login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/post-login/route\",\n        pathname: \"/api/auth/post-login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/post-login/route\"\n    },\n    resolvedPagePath: \"J:\\\\nino360\\\\app\\\\api\\\\auth\\\\post-login\\\\route.ts\",\n    nextConfigOutput,\n    userland: J_nino360_app_api_auth_post_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/post-login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjE4X0BiYWJlbCtjb3JlQDcuXzhhZDI3MTYxNTY3MjdjYjY2ZjZmNTY0MjJjN2I2OTlmL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci5qcz9uYW1lPWFwcCUyRmFwaSUyRmF1dGglMkZwb3N0LWxvZ2luJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdXRoJTJGcG9zdC1sb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZwb3N0LWxvZ2luJTJGcm91dGUudHMmYXBwRGlyPUolM0ElNUNuaW5vMzYwJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1KJTNBJTVDbmlubzM2MCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDQztBQUM5RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL25pbm8zNjAtY29udGFjdHMtdjAvPzAyZmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiSjpcXFxcbmlubzM2MFxcXFxhcHBcXFxcYXBpXFxcXGF1dGhcXFxccG9zdC1sb2dpblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9wb3N0LWxvZ2luL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9wb3N0LWxvZ2luXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdXRoL3Bvc3QtbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJKOlxcXFxuaW5vMzYwXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxwb3N0LWxvZ2luXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL3Bvc3QtbG9naW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fpost-login%2Froute&page=%2Fapi%2Fauth%2Fpost-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fpost-login%2Froute.ts&appDir=J%3A%5Cnino360%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=J%3A%5Cnino360&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/post-login/route.ts":
/*!******************************************!*\
  !*** ./app/api/auth/post-login/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_rbac_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/rbac/server */ \"(rsc)/./lib/rbac/server.ts\");\n\n\n\nasync function GET() {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n        const { data } = await supabase.auth.getUser();\n        if (!data?.user) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            roles: []\n        });\n        const perms = await (0,_lib_rbac_server__WEBPACK_IMPORTED_MODULE_2__.getUserPermissionsWithFlac)();\n        // Ensure a consistent shape\n        const out = {\n            permissions: Array.isArray(perms.permissions) ? perms.permissions : [],\n            roles: Array.isArray(perms.roles) ? perms.roles : [],\n            flac: perms.flac || {}\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(out);\n    } catch (err) {\n        // Log the error server-side and return a conservative response\n        try {\n            // eslint-disable-next-line @typescript-eslint/no-var-requires\n            const { logger } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/logger */ \"(rsc)/./lib/logger.ts\"));\n            logger.error(\"post-login GET failed\", err);\n        } catch  {\n        // ignore logger errors\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            permissions: [],\n            roles: [],\n            error: String(err)\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvcG9zdC1sb2dpbi9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTBDO0FBQ2dCO0FBQ0k7QUFFdkQsZUFBZUc7SUFDcEIsSUFBSTtRQUNGLE1BQU1DLFdBQVcsTUFBTUgsd0VBQWtCQTtRQUN6QyxNQUFNLEVBQUVJLElBQUksRUFBRSxHQUFHLE1BQU1ELFNBQVNFLElBQUksQ0FBQ0MsT0FBTztRQUU1QyxJQUFJLENBQUNGLE1BQU1HLE1BQU0sT0FBT1IscURBQVlBLENBQUNTLElBQUksQ0FBQztZQUFFQyxPQUFPLEVBQUU7UUFBQztRQUV0RCxNQUFNQyxRQUFRLE1BQU1ULDRFQUEwQkE7UUFDOUMsNEJBQTRCO1FBQzVCLE1BQU1VLE1BQU07WUFDVkMsYUFBYUMsTUFBTUMsT0FBTyxDQUFDSixNQUFNRSxXQUFXLElBQUlGLE1BQU1FLFdBQVcsR0FBRyxFQUFFO1lBQ3RFSCxPQUFPSSxNQUFNQyxPQUFPLENBQUNKLE1BQU1ELEtBQUssSUFBSUMsTUFBTUQsS0FBSyxHQUFHLEVBQUU7WUFDcERNLE1BQU1MLE1BQU1LLElBQUksSUFBSSxDQUFDO1FBQ3ZCO1FBQ0EsT0FBT2hCLHFEQUFZQSxDQUFDUyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT0ssS0FBVTtRQUNqQiwrREFBK0Q7UUFDL0QsSUFBSTtZQUNGLDhEQUE4RDtZQUM5RCxNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHLE1BQU0saUlBQU87WUFDaENBLE9BQU9DLEtBQUssQ0FBQyx5QkFBeUJGO1FBQ3hDLEVBQUUsT0FBTTtRQUNOLHVCQUF1QjtRQUN6QjtRQUNBLE9BQU9qQixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQUVJLGFBQWEsRUFBRTtZQUFFSCxPQUFPLEVBQUU7WUFBRVMsT0FBT0MsT0FBT0g7UUFBSyxHQUFHO1lBQUVJLFFBQVE7UUFBSTtJQUM3RjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmlubzM2MC1jb250YWN0cy12MC8uL2FwcC9hcGkvYXV0aC9wb3N0LWxvZ2luL3JvdXRlLnRzPzRiYjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcidcclxuaW1wb3J0IHsgZ2V0VXNlclBlcm1pc3Npb25zV2l0aEZsYWMgfSBmcm9tICdAL2xpYi9yYmFjL3NlcnZlcidcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcclxuXHJcbiAgICBpZiAoIWRhdGE/LnVzZXIpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJvbGVzOiBbXSB9KVxyXG5cclxuICAgIGNvbnN0IHBlcm1zID0gYXdhaXQgZ2V0VXNlclBlcm1pc3Npb25zV2l0aEZsYWMoKVxyXG4gICAgLy8gRW5zdXJlIGEgY29uc2lzdGVudCBzaGFwZVxyXG4gICAgY29uc3Qgb3V0ID0ge1xyXG4gICAgICBwZXJtaXNzaW9uczogQXJyYXkuaXNBcnJheShwZXJtcy5wZXJtaXNzaW9ucykgPyBwZXJtcy5wZXJtaXNzaW9ucyA6IFtdLFxyXG4gICAgICByb2xlczogQXJyYXkuaXNBcnJheShwZXJtcy5yb2xlcykgPyBwZXJtcy5yb2xlcyA6IFtdLFxyXG4gICAgICBmbGFjOiBwZXJtcy5mbGFjIHx8IHt9LFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG91dClcclxuICB9IGNhdGNoIChlcnI6IGFueSkge1xyXG4gICAgLy8gTG9nIHRoZSBlcnJvciBzZXJ2ZXItc2lkZSBhbmQgcmV0dXJuIGEgY29uc2VydmF0aXZlIHJlc3BvbnNlXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXZhci1yZXF1aXJlc1xyXG4gICAgICBjb25zdCB7IGxvZ2dlciB9ID0gYXdhaXQgaW1wb3J0KCdAL2xpYi9sb2dnZXInKVxyXG4gICAgICBsb2dnZXIuZXJyb3IoJ3Bvc3QtbG9naW4gR0VUIGZhaWxlZCcsIGVycilcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICAvLyBpZ25vcmUgbG9nZ2VyIGVycm9yc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcGVybWlzc2lvbnM6IFtdLCByb2xlczogW10sIGVycm9yOiBTdHJpbmcoZXJyKSB9LCB7IHN0YXR1czogNTAwIH0pXHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJnZXRVc2VyUGVybWlzc2lvbnNXaXRoRmxhYyIsIkdFVCIsInN1cGFiYXNlIiwiZGF0YSIsImF1dGgiLCJnZXRVc2VyIiwidXNlciIsImpzb24iLCJyb2xlcyIsInBlcm1zIiwib3V0IiwicGVybWlzc2lvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJmbGFjIiwiZXJyIiwibG9nZ2VyIiwiZXJyb3IiLCJTdHJpbmciLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/post-login/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/logger.ts":
/*!***********************!*\
  !*** ./lib/logger.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   log: () => (/* binding */ log),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/**\r\n * Production-ready logging utility\r\n *\r\n * Features:\r\n * - Environment-based log levels\r\n * - Feature flag support for debug logs\r\n * - Structured logging with context\r\n * - Error tracking integration ready\r\n */ class Logger {\n    /**\r\n   * Debug logs - only in development or when explicitly enabled\r\n   */ debug(message, context) {\n        if (this.isDevelopment || this.debugEnabled) {\n            console.log(`[DEBUG] ${message}`, context || \"\");\n        }\n    }\n    /**\r\n   * Info logs - general information\r\n   */ info(message, context) {\n        if (this.isDevelopment) {\n            console.log(`[INFO] ${message}`, context || \"\");\n        }\n    }\n    /**\r\n   * Warning logs - potential issues\r\n   */ warn(message, context) {\n        console.warn(`[WARN] ${message}`, context || \"\");\n    }\n    /**\r\n   * Error logs - actual errors that need attention\r\n   */ error(message, error, context) {\n        console.error(`[ERROR] ${message}`, {\n            error: error instanceof Error ? {\n                message: error.message,\n                stack: error.stack,\n                name: error.name\n            } : error,\n            ...context\n        });\n    // TODO: Send to error tracking service (Sentry, etc.)\n    // if (typeof window !== 'undefined' && window.Sentry) {\n    //   window.Sentry.captureException(error, { extra: context })\n    // }\n    }\n    /**\r\n   * Action logs - user actions for audit trail\r\n   */ action(action, context) {\n        if (this.isDevelopment) {\n            console.log(`[ACTION] ${action}`, context || \"\");\n        }\n    // TODO: Send to analytics service\n    // if (typeof window !== 'undefined' && window.analytics) {\n    //   window.analytics.track(action, context)\n    // }\n    }\n    constructor(){\n        this.isDevelopment = \"development\" === \"development\";\n        this.debugEnabled = process.env.NEXT_PUBLIC_DEBUG_LOGS === \"true\";\n    }\n}\nconst logger = new Logger();\n/**\r\n * Legacy console.log replacement\r\n * Use this to gradually migrate from console.log to structured logging\r\n */ function log(message, ...args) {\n    if (true) {\n        console.log(message, ...args);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7O0NBUUMsR0FRRCxNQUFNQTtJQUlKOztHQUVDLEdBQ0RDLE1BQU1DLE9BQWUsRUFBRUMsT0FBb0IsRUFBRTtRQUMzQyxJQUFJLElBQUksQ0FBQ0MsYUFBYSxJQUFJLElBQUksQ0FBQ0MsWUFBWSxFQUFFO1lBQzNDQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUVMLFFBQVEsQ0FBQyxFQUFFQyxXQUFXO1FBQy9DO0lBQ0Y7SUFFQTs7R0FFQyxHQUNESyxLQUFLTixPQUFlLEVBQUVDLE9BQW9CLEVBQUU7UUFDMUMsSUFBSSxJQUFJLENBQUNDLGFBQWEsRUFBRTtZQUN0QkUsUUFBUUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFTCxRQUFRLENBQUMsRUFBRUMsV0FBVztRQUM5QztJQUNGO0lBRUE7O0dBRUMsR0FDRE0sS0FBS1AsT0FBZSxFQUFFQyxPQUFvQixFQUFFO1FBQzFDRyxRQUFRRyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUVQLFFBQVEsQ0FBQyxFQUFFQyxXQUFXO0lBQy9DO0lBRUE7O0dBRUMsR0FDRE8sTUFBTVIsT0FBZSxFQUFFUSxLQUF1QixFQUFFUCxPQUFvQixFQUFFO1FBQ3BFRyxRQUFRSSxLQUFLLENBQUMsQ0FBQyxRQUFRLEVBQUVSLFFBQVEsQ0FBQyxFQUFFO1lBQ2xDUSxPQUNFQSxpQkFBaUJDLFFBQ2I7Z0JBQ0VULFNBQVNRLE1BQU1SLE9BQU87Z0JBQ3RCVSxPQUFPRixNQUFNRSxLQUFLO2dCQUNsQkMsTUFBTUgsTUFBTUcsSUFBSTtZQUNsQixJQUNBSDtZQUNOLEdBQUdQLE9BQU87UUFDWjtJQUVBLHNEQUFzRDtJQUN0RCx3REFBd0Q7SUFDeEQsOERBQThEO0lBQzlELElBQUk7SUFDTjtJQUVBOztHQUVDLEdBQ0RXLE9BQU9BLE1BQWMsRUFBRVgsT0FBb0IsRUFBRTtRQUMzQyxJQUFJLElBQUksQ0FBQ0MsYUFBYSxFQUFFO1lBQ3RCRSxRQUFRQyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUVPLE9BQU8sQ0FBQyxFQUFFWCxXQUFXO1FBQy9DO0lBRUEsa0NBQWtDO0lBQ2xDLDJEQUEyRDtJQUMzRCw0Q0FBNEM7SUFDNUMsSUFBSTtJQUNOOzthQTlEUUMsZ0JBQWdCVyxrQkFBeUI7YUFDekNWLGVBQWVVLFFBQVFDLEdBQUcsQ0FBQ0Msc0JBQXNCLEtBQUs7O0FBOERoRTtBQUVPLE1BQU1DLFNBQVMsSUFBSWxCLFNBQVE7QUFFbEM7OztDQUdDLEdBQ00sU0FBU08sSUFBSUwsT0FBZSxFQUFFLEdBQUdpQixJQUFXO0lBQ2pELElBQUlKLElBQXNDLEVBQUU7UUFDMUNULFFBQVFDLEdBQUcsQ0FBQ0wsWUFBWWlCO0lBQzFCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uaW5vMzYwLWNvbnRhY3RzLXYwLy4vbGliL2xvZ2dlci50cz9mZDVkIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBQcm9kdWN0aW9uLXJlYWR5IGxvZ2dpbmcgdXRpbGl0eVxyXG4gKlxyXG4gKiBGZWF0dXJlczpcclxuICogLSBFbnZpcm9ubWVudC1iYXNlZCBsb2cgbGV2ZWxzXHJcbiAqIC0gRmVhdHVyZSBmbGFnIHN1cHBvcnQgZm9yIGRlYnVnIGxvZ3NcclxuICogLSBTdHJ1Y3R1cmVkIGxvZ2dpbmcgd2l0aCBjb250ZXh0XHJcbiAqIC0gRXJyb3IgdHJhY2tpbmcgaW50ZWdyYXRpb24gcmVhZHlcclxuICovXHJcblxyXG50eXBlIExvZ0xldmVsID0gXCJkZWJ1Z1wiIHwgXCJpbmZvXCIgfCBcIndhcm5cIiB8IFwiZXJyb3JcIlxyXG5cclxuaW50ZXJmYWNlIExvZ0NvbnRleHQge1xyXG4gIFtrZXk6IHN0cmluZ106IGFueVxyXG59XHJcblxyXG5jbGFzcyBMb2dnZXIge1xyXG4gIHByaXZhdGUgaXNEZXZlbG9wbWVudCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCJcclxuICBwcml2YXRlIGRlYnVnRW5hYmxlZCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0RFQlVHX0xPR1MgPT09IFwidHJ1ZVwiXHJcblxyXG4gIC8qKlxyXG4gICAqIERlYnVnIGxvZ3MgLSBvbmx5IGluIGRldmVsb3BtZW50IG9yIHdoZW4gZXhwbGljaXRseSBlbmFibGVkXHJcbiAgICovXHJcbiAgZGVidWcobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xyXG4gICAgaWYgKHRoaXMuaXNEZXZlbG9wbWVudCB8fCB0aGlzLmRlYnVnRW5hYmxlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSAke21lc3NhZ2V9YCwgY29udGV4dCB8fCBcIlwiKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5mbyBsb2dzIC0gZ2VuZXJhbCBpbmZvcm1hdGlvblxyXG4gICAqL1xyXG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xyXG4gICAgaWYgKHRoaXMuaXNEZXZlbG9wbWVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW0lORk9dICR7bWVzc2FnZX1gLCBjb250ZXh0IHx8IFwiXCIpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXJuaW5nIGxvZ3MgLSBwb3RlbnRpYWwgaXNzdWVzXHJcbiAgICovXHJcbiAgd2FybihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBMb2dDb250ZXh0KSB7XHJcbiAgICBjb25zb2xlLndhcm4oYFtXQVJOXSAke21lc3NhZ2V9YCwgY29udGV4dCB8fCBcIlwiKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXJyb3IgbG9ncyAtIGFjdHVhbCBlcnJvcnMgdGhhdCBuZWVkIGF0dGVudGlvblxyXG4gICAqL1xyXG4gIGVycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBFcnJvciB8IHVua25vd24sIGNvbnRleHQ/OiBMb2dDb250ZXh0KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbRVJST1JdICR7bWVzc2FnZX1gLCB7XHJcbiAgICAgIGVycm9yOlxyXG4gICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3JcclxuICAgICAgICAgID8ge1xyXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxyXG4gICAgICAgICAgICAgIG5hbWU6IGVycm9yLm5hbWUsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIDogZXJyb3IsXHJcbiAgICAgIC4uLmNvbnRleHQsXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFRPRE86IFNlbmQgdG8gZXJyb3IgdHJhY2tpbmcgc2VydmljZSAoU2VudHJ5LCBldGMuKVxyXG4gICAgLy8gaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5TZW50cnkpIHtcclxuICAgIC8vICAgd2luZG93LlNlbnRyeS5jYXB0dXJlRXhjZXB0aW9uKGVycm9yLCB7IGV4dHJhOiBjb250ZXh0IH0pXHJcbiAgICAvLyB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBY3Rpb24gbG9ncyAtIHVzZXIgYWN0aW9ucyBmb3IgYXVkaXQgdHJhaWxcclxuICAgKi9cclxuICBhY3Rpb24oYWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBMb2dDb250ZXh0KSB7XHJcbiAgICBpZiAodGhpcy5pc0RldmVsb3BtZW50KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbQUNUSU9OXSAke2FjdGlvbn1gLCBjb250ZXh0IHx8IFwiXCIpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVE9ETzogU2VuZCB0byBhbmFseXRpY3Mgc2VydmljZVxyXG4gICAgLy8gaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5hbmFseXRpY3MpIHtcclxuICAgIC8vICAgd2luZG93LmFuYWx5dGljcy50cmFjayhhY3Rpb24sIGNvbnRleHQpXHJcbiAgICAvLyB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcigpXHJcblxyXG4vKipcclxuICogTGVnYWN5IGNvbnNvbGUubG9nIHJlcGxhY2VtZW50XHJcbiAqIFVzZSB0aGlzIHRvIGdyYWR1YWxseSBtaWdyYXRlIGZyb20gY29uc29sZS5sb2cgdG8gc3RydWN0dXJlZCBsb2dnaW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbG9nKG1lc3NhZ2U6IHN0cmluZywgLi4uYXJnczogYW55W10pIHtcclxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIikge1xyXG4gICAgY29uc29sZS5sb2cobWVzc2FnZSwgLi4uYXJncylcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkxvZ2dlciIsImRlYnVnIiwibWVzc2FnZSIsImNvbnRleHQiLCJpc0RldmVsb3BtZW50IiwiZGVidWdFbmFibGVkIiwiY29uc29sZSIsImxvZyIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJFcnJvciIsInN0YWNrIiwibmFtZSIsImFjdGlvbiIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19ERUJVR19MT0dTIiwibG9nZ2VyIiwiYXJncyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/logger.ts\n");

/***/ }),

/***/ "(rsc)/./lib/rbac/server.ts":
/*!****************************!*\
  !*** ./lib/rbac/server.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getUserPermissions: () => (/* binding */ getUserPermissions),\n/* harmony export */   getUserPermissionsWithFlac: () => (/* binding */ getUserPermissionsWithFlac),\n/* harmony export */   guardAdmin: () => (/* binding */ guardAdmin),\n/* harmony export */   hasAllPermissions: () => (/* binding */ hasAllPermissions),\n/* harmony export */   hasAnyPermission: () => (/* binding */ hasAnyPermission),\n/* harmony export */   hasAnyRole: () => (/* binding */ hasAnyRole),\n/* harmony export */   hasPermission: () => (/* binding */ hasPermission),\n/* harmony export */   hasRole: () => (/* binding */ hasRole),\n/* harmony export */   requirePermission: () => (/* binding */ requirePermission),\n/* harmony export */   requireRole: () => (/* binding */ requireRole)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./lib/logger.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"0e8f398a3647b5c293497d2df941dac18ba60233\":\"requireRole\",\"344db619b47004e08eefb19da32aa5695d8fe972\":\"hasPermission\",\"50be76164bd1401cf2568c2f79d35d321c98ccd3\":\"hasAnyPermission\",\"6efd094c1e87bc967eaa382c9cd11b328af3577c\":\"guardAdmin\",\"7d98fb2dc08ce30a2cd7cf3c2af050c5544df6fc\":\"hasAnyRole\",\"88d34f91fa5aee6f60ceb15f4a9381230ba169ef\":\"hasRole\",\"af242744b7ca3803f8d8907c6cbaccb9e14e4c95\":\"hasAllPermissions\",\"d21e73ce447c8efaa2b2729c96fd388ec5208811\":\"getUserPermissionsWithFlac\",\"e228eed94a6da3144bba80081405a85f388674ea\":\"getUserPermissions\",\"f5efb7f4845ed700787452d43de5918d80b4b145\":\"requirePermission\"} */ \n\n\n\n/**\r\n * Development-only RBAC bypass\r\n * Enable by setting RBAC_BYPASS=1 (ignored in production)\r\n */ async function rbacBypassEnabled() {\n    if ( false || process.env.RBAC_BYPASS !== \"1\") return false;\n    // Only enable bypass for authenticated users to avoid anonymous access causing downstream errors\n    const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerClient)();\n    const { data } = await supabase.auth.getUser();\n    return !!data.user;\n}\n/**\r\n * Get current user's permissions for the current tenant\r\n */ async function getUserPermissions() {\n    // Development shortcut: when DEV_FAKE_USER_ID is set we return a safe\n    // default permission set to make local development easier without a\n    // full authenticated Supabase session. This avoids frequent JWT expired\n    // and RPC errors during development.\n    if ( true && process.env.DEV_FAKE_USER_ID) {\n        return {\n            permissions: [\n                // common development permissions used by the analytics UI\n                \"crm:analytics:read\",\n                \"crm:analytics:ai\",\n                \"crm:contacts:read\"\n            ],\n            roles: [\n                {\n                    key: \"dev\",\n                    label: \"Developer (dev-fake)\"\n                }\n            ]\n        };\n    }\n    const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerClient)();\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) {\n        return {\n            permissions: [],\n            roles: []\n        };\n    }\n    // Get tenant_id from user metadata (now from authenticated user object)\n    const tenantId = user.user_metadata?.tenant_id;\n    if (!tenantId) {\n        return {\n            permissions: [],\n            roles: []\n        };\n    }\n    // Get permissions and roles via safe RPC calls. RPC functions may fail (missing\n    // function, DB error, permission issue) so wrap calls and return conservative\n    // defaults to avoid throwing during simple permission checks.\n    let permissions = null;\n    let roles = null;\n    try {\n        const resp = await supabase.rpc(\"get_user_permissions\", {\n            _user_id: user.id,\n            _tenant_id: tenantId\n        });\n        permissions = resp.data ?? null;\n    } catch (err) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn(\"get_user_permissions RPC failed\", err);\n        permissions = null;\n    }\n    try {\n        const resp = await supabase.rpc(\"get_user_roles\", {\n            _user_id: user.id,\n            _tenant_id: tenantId\n        });\n        roles = resp.data ?? null;\n    } catch (err) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn(\"get_user_roles RPC failed\", err);\n        roles = null;\n    }\n    return {\n        permissions: permissions?.map((p)=>p.permission_key) || [],\n        roles: roles || []\n    };\n}\n/**\r\n * Return permissions along with a lightweight FLAC (field-level access control)\r\n * derived from permission flags. This is intentionally simple: production systems\r\n * may need a richer FLAC model stored in the DB.\r\n */ async function getUserPermissionsWithFlac() {\n    const perms = await getUserPermissions();\n    const p = perms.permissions;\n    const flac = {};\n    // If the user can update contacts, allow writing common fields\n    if (p.includes(\"crm.contacts.update\") || p.includes(\"crm.contacts.create\")) {\n        flac.contacts = {\n            write: [\n                \"first_name\",\n                \"last_name\",\n                \"email\",\n                \"phone\",\n                \"company\",\n                \"title\",\n                \"tags\",\n                \"notes\"\n            ],\n            read: [\n                \"*\"\n            ]\n        };\n    } else if (p.includes(\"crm.contacts.read\")) {\n        flac.contacts = {\n            read: [\n                \"first_name\",\n                \"last_name\",\n                \"email\",\n                \"phone\",\n                \"company\",\n                \"title\"\n            ]\n        };\n    }\n    return {\n        ...perms,\n        flac\n    };\n}\n/**\r\n * Check if user has a specific permission\r\n */ async function hasPermission(permission) {\n    if (await rbacBypassEnabled()) return true;\n    const { permissions } = await getUserPermissions();\n    return permissions.includes(permission);\n}\n/**\r\n * Check if user has any of the specified permissions\r\n */ async function hasAnyPermission(permissions) {\n    if (await rbacBypassEnabled()) return true;\n    const userPerms = await getUserPermissions();\n    return permissions.some((p)=>userPerms.permissions.includes(p));\n}\n/**\r\n * Check if user has all of the specified permissions\r\n */ async function hasAllPermissions(permissions) {\n    if (await rbacBypassEnabled()) return true;\n    const userPerms = await getUserPermissions();\n    return permissions.every((p)=>userPerms.permissions.includes(p));\n}\n/**\r\n * Check if user has a specific role\r\n */ async function hasRole(role) {\n    if (await rbacBypassEnabled()) return true;\n    const { roles } = await getUserPermissions();\n    return roles.some((r)=>r.key === role);\n}\n/**\r\n * Check if user has any of the specified roles\r\n */ async function hasAnyRole(roles) {\n    if (await rbacBypassEnabled()) return true;\n    const userRoles = await getUserPermissions();\n    return roles.some((r)=>userRoles.roles.some((ur)=>ur.key === r));\n}\n/**\r\n * Require permission or throw error\r\n */ async function requirePermission(permission) {\n    if (await rbacBypassEnabled()) return;\n    const allowed = await hasPermission(permission);\n    if (!allowed) {\n        throw new Error(`Permission denied: ${permission}`);\n    }\n}\n/**\r\n * Require role or throw error\r\n */ async function requireRole(role) {\n    if (await rbacBypassEnabled()) return;\n    const allowed = await hasRole(role);\n    if (!allowed) {\n        throw new Error(`Role required: ${role}`);\n    }\n}\n/**\r\n * Guard function to ensure user has admin role\r\n * Throws error if user is not an admin\r\n */ async function guardAdmin() {\n    await requireRole(\"admin\");\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__.ensureServerEntryExports)([\n    getUserPermissions,\n    getUserPermissionsWithFlac,\n    hasPermission,\n    hasAnyPermission,\n    hasAllPermissions,\n    hasRole,\n    hasAnyRole,\n    requirePermission,\n    requireRole,\n    guardAdmin\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"e228eed94a6da3144bba80081405a85f388674ea\", getUserPermissions);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"d21e73ce447c8efaa2b2729c96fd388ec5208811\", getUserPermissionsWithFlac);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"344db619b47004e08eefb19da32aa5695d8fe972\", hasPermission);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"50be76164bd1401cf2568c2f79d35d321c98ccd3\", hasAnyPermission);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"af242744b7ca3803f8d8907c6cbaccb9e14e4c95\", hasAllPermissions);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"88d34f91fa5aee6f60ceb15f4a9381230ba169ef\", hasRole);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"7d98fb2dc08ce30a2cd7cf3c2af050c5544df6fc\", hasAnyRole);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"f5efb7f4845ed700787452d43de5918d80b4b145\", requirePermission);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"0e8f398a3647b5c293497d2df941dac18ba60233\", requireRole);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"6efd094c1e87bc967eaa382c9cd11b328af3577c\", guardAdmin);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMyQixJQUFJLENBQUMsQ0FBQ1EsS0FBT0EsR0FBR2xDLEdBQUcsS0FBSytCO0FBQ25FO0FBRUE7O0NBRUMsR0FDTSxlQUFlSSxrQkFBa0JaLFVBQXNCO0lBQzVELElBQUksTUFBTXBDLHFCQUFxQjtJQUMvQixNQUFNaUQsVUFBVSxNQUFNZCxjQUFjQztJQUNwQyxJQUFJLENBQUNhLFNBQVM7UUFDWixNQUFNLElBQUlDLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRWQsV0FBVyxDQUFDO0lBQ3BEO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVlLFlBQVlSLElBQVU7SUFDMUMsSUFBSSxNQUFNM0MscUJBQXFCO0lBQy9CLE1BQU1pRCxVQUFVLE1BQU1QLFFBQVFDO0lBQzlCLElBQUksQ0FBQ00sU0FBUztRQUNaLE1BQU0sSUFBSUMsTUFBTSxDQUFDLGVBQWUsRUFBRVAsS0FBSyxDQUFDO0lBQzFDO0FBQ0Y7QUFFQTs7O0NBR0MsR0FDTSxlQUFlUztJQUNwQixNQUFNRCxZQUFZO0FBQ3BCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmlubzM2MC1jb250YWN0cy12MC8uL2xpYi9yYmFjL3NlcnZlci50cz8xY2FmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHNlcnZlclwiXHJcblxyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Uvc2VydmVyXCJcclxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIkAvbGliL2xvZ2dlclwiXHJcbmltcG9ydCB0eXBlIHsgUGVybWlzc2lvbiwgUm9sZSB9IGZyb20gXCIuL3Blcm1pc3Npb25zXCJcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlclBlcm1pc3Npb25zIHtcclxuICBwZXJtaXNzaW9uczogc3RyaW5nW11cclxuICByb2xlczogQXJyYXk8eyBrZXk6IHN0cmluZzsgbGFiZWw6IHN0cmluZyB9PlxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTGV2ZWxBY2Nlc3Mge1xyXG4gIGNvbnRhY3RzPzogeyByZWFkPzogc3RyaW5nW107IHdyaXRlPzogc3RyaW5nW10gfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJQZXJtaXNzaW9uc1dpdGhGbGFjIGV4dGVuZHMgVXNlclBlcm1pc3Npb25zIHtcclxuICBmbGFjPzogRmllbGRMZXZlbEFjY2Vzc1xyXG59XHJcblxyXG4vKipcclxuICogRGV2ZWxvcG1lbnQtb25seSBSQkFDIGJ5cGFzc1xyXG4gKiBFbmFibGUgYnkgc2V0dGluZyBSQkFDX0JZUEFTUz0xIChpZ25vcmVkIGluIHByb2R1Y3Rpb24pXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByYmFjQnlwYXNzRW5hYmxlZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiIHx8IHByb2Nlc3MuZW52LlJCQUNfQllQQVNTICE9PSBcIjFcIikgcmV0dXJuIGZhbHNlXHJcbiAgLy8gT25seSBlbmFibGUgYnlwYXNzIGZvciBhdXRoZW50aWNhdGVkIHVzZXJzIHRvIGF2b2lkIGFub255bW91cyBhY2Nlc3MgY2F1c2luZyBkb3duc3RyZWFtIGVycm9yc1xyXG4gIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXHJcbiAgcmV0dXJuICEhZGF0YS51c2VyXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCB1c2VyJ3MgcGVybWlzc2lvbnMgZm9yIHRoZSBjdXJyZW50IHRlbmFudFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJQZXJtaXNzaW9ucygpOiBQcm9taXNlPFVzZXJQZXJtaXNzaW9ucz4ge1xyXG4gIC8vIERldmVsb3BtZW50IHNob3J0Y3V0OiB3aGVuIERFVl9GQUtFX1VTRVJfSUQgaXMgc2V0IHdlIHJldHVybiBhIHNhZmVcclxuICAvLyBkZWZhdWx0IHBlcm1pc3Npb24gc2V0IHRvIG1ha2UgbG9jYWwgZGV2ZWxvcG1lbnQgZWFzaWVyIHdpdGhvdXQgYVxyXG4gIC8vIGZ1bGwgYXV0aGVudGljYXRlZCBTdXBhYmFzZSBzZXNzaW9uLiBUaGlzIGF2b2lkcyBmcmVxdWVudCBKV1QgZXhwaXJlZFxyXG4gIC8vIGFuZCBSUEMgZXJyb3JzIGR1cmluZyBkZXZlbG9wbWVudC5cclxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiICYmIHByb2Nlc3MuZW52LkRFVl9GQUtFX1VTRVJfSUQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHBlcm1pc3Npb25zOiBbXHJcbiAgICAgICAgLy8gY29tbW9uIGRldmVsb3BtZW50IHBlcm1pc3Npb25zIHVzZWQgYnkgdGhlIGFuYWx5dGljcyBVSVxyXG4gICAgICAgIFwiY3JtOmFuYWx5dGljczpyZWFkXCIsXHJcbiAgICAgICAgXCJjcm06YW5hbHl0aWNzOmFpXCIsXHJcbiAgICAgICAgXCJjcm06Y29udGFjdHM6cmVhZFwiLFxyXG4gICAgICBdLFxyXG4gICAgICByb2xlczogW3sga2V5OiBcImRldlwiLCBsYWJlbDogXCJEZXZlbG9wZXIgKGRldi1mYWtlKVwiIH1dLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG5cclxuICBjb25zdCB7XHJcbiAgICBkYXRhOiB7IHVzZXIgfSxcclxuICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcclxuXHJcbiAgaWYgKCF1c2VyKSB7XHJcbiAgICByZXR1cm4geyBwZXJtaXNzaW9uczogW10sIHJvbGVzOiBbXSB9XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgdGVuYW50X2lkIGZyb20gdXNlciBtZXRhZGF0YSAobm93IGZyb20gYXV0aGVudGljYXRlZCB1c2VyIG9iamVjdClcclxuICBjb25zdCB0ZW5hbnRJZCA9IHVzZXIudXNlcl9tZXRhZGF0YT8udGVuYW50X2lkXHJcblxyXG4gIGlmICghdGVuYW50SWQpIHtcclxuICAgIHJldHVybiB7IHBlcm1pc3Npb25zOiBbXSwgcm9sZXM6IFtdIH1cclxuICB9XHJcblxyXG4gIC8vIEdldCBwZXJtaXNzaW9ucyBhbmQgcm9sZXMgdmlhIHNhZmUgUlBDIGNhbGxzLiBSUEMgZnVuY3Rpb25zIG1heSBmYWlsIChtaXNzaW5nXHJcbiAgLy8gZnVuY3Rpb24sIERCIGVycm9yLCBwZXJtaXNzaW9uIGlzc3VlKSBzbyB3cmFwIGNhbGxzIGFuZCByZXR1cm4gY29uc2VydmF0aXZlXHJcbiAgLy8gZGVmYXVsdHMgdG8gYXZvaWQgdGhyb3dpbmcgZHVyaW5nIHNpbXBsZSBwZXJtaXNzaW9uIGNoZWNrcy5cclxuICBsZXQgcGVybWlzc2lvbnM6IGFueVtdIHwgbnVsbCA9IG51bGxcclxuICBsZXQgcm9sZXM6IGFueVtdIHwgbnVsbCA9IG51bGxcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBzdXBhYmFzZS5ycGMoXCJnZXRfdXNlcl9wZXJtaXNzaW9uc1wiLCB7XHJcbiAgICAgIF91c2VyX2lkOiB1c2VyLmlkLFxyXG4gICAgICBfdGVuYW50X2lkOiB0ZW5hbnRJZCxcclxuICAgIH0pXHJcbiAgICBwZXJtaXNzaW9ucyA9IChyZXNwIGFzIGFueSkuZGF0YSA/PyBudWxsXHJcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcclxuICAgIGxvZ2dlci53YXJuKFwiZ2V0X3VzZXJfcGVybWlzc2lvbnMgUlBDIGZhaWxlZFwiLCBlcnIpXHJcbiAgICBwZXJtaXNzaW9ucyA9IG51bGxcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwID0gYXdhaXQgc3VwYWJhc2UucnBjKFwiZ2V0X3VzZXJfcm9sZXNcIiwge1xyXG4gICAgICBfdXNlcl9pZDogdXNlci5pZCxcclxuICAgICAgX3RlbmFudF9pZDogdGVuYW50SWQsXHJcbiAgICB9KVxyXG4gICAgcm9sZXMgPSAocmVzcCBhcyBhbnkpLmRhdGEgPz8gbnVsbFxyXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICBsb2dnZXIud2FybihcImdldF91c2VyX3JvbGVzIFJQQyBmYWlsZWRcIiwgZXJyKVxyXG4gICAgcm9sZXMgPSBudWxsXHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcGVybWlzc2lvbnM6IHBlcm1pc3Npb25zPy5tYXAoKHA6IGFueSkgPT4gcC5wZXJtaXNzaW9uX2tleSkgfHwgW10sXHJcbiAgICByb2xlczogcm9sZXMgfHwgW10sXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmV0dXJuIHBlcm1pc3Npb25zIGFsb25nIHdpdGggYSBsaWdodHdlaWdodCBGTEFDIChmaWVsZC1sZXZlbCBhY2Nlc3MgY29udHJvbClcclxuICogZGVyaXZlZCBmcm9tIHBlcm1pc3Npb24gZmxhZ3MuIFRoaXMgaXMgaW50ZW50aW9uYWxseSBzaW1wbGU6IHByb2R1Y3Rpb24gc3lzdGVtc1xyXG4gKiBtYXkgbmVlZCBhIHJpY2hlciBGTEFDIG1vZGVsIHN0b3JlZCBpbiB0aGUgREIuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclBlcm1pc3Npb25zV2l0aEZsYWMoKTogUHJvbWlzZTxVc2VyUGVybWlzc2lvbnNXaXRoRmxhYz4ge1xyXG4gIGNvbnN0IHBlcm1zID0gYXdhaXQgZ2V0VXNlclBlcm1pc3Npb25zKClcclxuICBjb25zdCBwID0gcGVybXMucGVybWlzc2lvbnNcclxuXHJcbiAgY29uc3QgZmxhYzogRmllbGRMZXZlbEFjY2VzcyA9IHt9XHJcblxyXG4gIC8vIElmIHRoZSB1c2VyIGNhbiB1cGRhdGUgY29udGFjdHMsIGFsbG93IHdyaXRpbmcgY29tbW9uIGZpZWxkc1xyXG4gIGlmIChwLmluY2x1ZGVzKFwiY3JtLmNvbnRhY3RzLnVwZGF0ZVwiKSB8fCBwLmluY2x1ZGVzKFwiY3JtLmNvbnRhY3RzLmNyZWF0ZVwiKSkge1xyXG4gICAgZmxhYy5jb250YWN0cyA9IHsgd3JpdGU6IFtcImZpcnN0X25hbWVcIiwgXCJsYXN0X25hbWVcIiwgXCJlbWFpbFwiLCBcInBob25lXCIsIFwiY29tcGFueVwiLCBcInRpdGxlXCIsIFwidGFnc1wiLCBcIm5vdGVzXCJdLCByZWFkOiBbXCIqXCJdIH1cclxuICB9IGVsc2UgaWYgKHAuaW5jbHVkZXMoXCJjcm0uY29udGFjdHMucmVhZFwiKSkge1xyXG4gICAgZmxhYy5jb250YWN0cyA9IHsgcmVhZDogW1wiZmlyc3RfbmFtZVwiLCBcImxhc3RfbmFtZVwiLCBcImVtYWlsXCIsIFwicGhvbmVcIiwgXCJjb21wYW55XCIsIFwidGl0bGVcIl0gfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgLi4ucGVybXMsIGZsYWMgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgdXNlciBoYXMgYSBzcGVjaWZpYyBwZXJtaXNzaW9uXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzUGVybWlzc2lvbihwZXJtaXNzaW9uOiBQZXJtaXNzaW9uKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgaWYgKGF3YWl0IHJiYWNCeXBhc3NFbmFibGVkKCkpIHJldHVybiB0cnVlXHJcbiAgY29uc3QgeyBwZXJtaXNzaW9ucyB9ID0gYXdhaXQgZ2V0VXNlclBlcm1pc3Npb25zKClcclxuICByZXR1cm4gcGVybWlzc2lvbnMuaW5jbHVkZXMocGVybWlzc2lvbilcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHVzZXIgaGFzIGFueSBvZiB0aGUgc3BlY2lmaWVkIHBlcm1pc3Npb25zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzQW55UGVybWlzc2lvbihwZXJtaXNzaW9uczogUGVybWlzc2lvbltdKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgaWYgKGF3YWl0IHJiYWNCeXBhc3NFbmFibGVkKCkpIHJldHVybiB0cnVlXHJcbiAgY29uc3QgdXNlclBlcm1zID0gYXdhaXQgZ2V0VXNlclBlcm1pc3Npb25zKClcclxuICByZXR1cm4gcGVybWlzc2lvbnMuc29tZSgocCkgPT4gdXNlclBlcm1zLnBlcm1pc3Npb25zLmluY2x1ZGVzKHApKVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgdXNlciBoYXMgYWxsIG9mIHRoZSBzcGVjaWZpZWQgcGVybWlzc2lvbnNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNBbGxQZXJtaXNzaW9ucyhwZXJtaXNzaW9uczogUGVybWlzc2lvbltdKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgaWYgKGF3YWl0IHJiYWNCeXBhc3NFbmFibGVkKCkpIHJldHVybiB0cnVlXHJcbiAgY29uc3QgdXNlclBlcm1zID0gYXdhaXQgZ2V0VXNlclBlcm1pc3Npb25zKClcclxuICByZXR1cm4gcGVybWlzc2lvbnMuZXZlcnkoKHApID0+IHVzZXJQZXJtcy5wZXJtaXNzaW9ucy5pbmNsdWRlcyhwKSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHVzZXIgaGFzIGEgc3BlY2lmaWMgcm9sZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc1JvbGUocm9sZTogUm9sZSk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIGlmIChhd2FpdCByYmFjQnlwYXNzRW5hYmxlZCgpKSByZXR1cm4gdHJ1ZVxyXG4gIGNvbnN0IHsgcm9sZXMgfSA9IGF3YWl0IGdldFVzZXJQZXJtaXNzaW9ucygpXHJcbiAgcmV0dXJuIHJvbGVzLnNvbWUoKHIpID0+IHIua2V5ID09PSByb2xlKVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgdXNlciBoYXMgYW55IG9mIHRoZSBzcGVjaWZpZWQgcm9sZXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNBbnlSb2xlKHJvbGVzOiBSb2xlW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBpZiAoYXdhaXQgcmJhY0J5cGFzc0VuYWJsZWQoKSkgcmV0dXJuIHRydWVcclxuICBjb25zdCB1c2VyUm9sZXMgPSBhd2FpdCBnZXRVc2VyUGVybWlzc2lvbnMoKVxyXG4gIHJldHVybiByb2xlcy5zb21lKChyKSA9PiB1c2VyUm9sZXMucm9sZXMuc29tZSgodXIpID0+IHVyLmtleSA9PT0gcikpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXF1aXJlIHBlcm1pc3Npb24gb3IgdGhyb3cgZXJyb3JcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUGVybWlzc2lvbihwZXJtaXNzaW9uOiBQZXJtaXNzaW9uKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgaWYgKGF3YWl0IHJiYWNCeXBhc3NFbmFibGVkKCkpIHJldHVyblxyXG4gIGNvbnN0IGFsbG93ZWQgPSBhd2FpdCBoYXNQZXJtaXNzaW9uKHBlcm1pc3Npb24pXHJcbiAgaWYgKCFhbGxvd2VkKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFBlcm1pc3Npb24gZGVuaWVkOiAke3Blcm1pc3Npb259YClcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXF1aXJlIHJvbGUgb3IgdGhyb3cgZXJyb3JcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUm9sZShyb2xlOiBSb2xlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgaWYgKGF3YWl0IHJiYWNCeXBhc3NFbmFibGVkKCkpIHJldHVyblxyXG4gIGNvbnN0IGFsbG93ZWQgPSBhd2FpdCBoYXNSb2xlKHJvbGUpXHJcbiAgaWYgKCFhbGxvd2VkKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFJvbGUgcmVxdWlyZWQ6ICR7cm9sZX1gKVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEd1YXJkIGZ1bmN0aW9uIHRvIGVuc3VyZSB1c2VyIGhhcyBhZG1pbiByb2xlXHJcbiAqIFRocm93cyBlcnJvciBpZiB1c2VyIGlzIG5vdCBhbiBhZG1pblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGd1YXJkQWRtaW4oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgYXdhaXQgcmVxdWlyZVJvbGUoXCJhZG1pblwiKVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJsb2dnZXIiLCJyYmFjQnlwYXNzRW5hYmxlZCIsInByb2Nlc3MiLCJlbnYiLCJSQkFDX0JZUEFTUyIsInN1cGFiYXNlIiwiZGF0YSIsImF1dGgiLCJnZXRVc2VyIiwidXNlciIsImdldFVzZXJQZXJtaXNzaW9ucyIsIkRFVl9GQUtFX1VTRVJfSUQiLCJwZXJtaXNzaW9ucyIsInJvbGVzIiwia2V5IiwibGFiZWwiLCJ0ZW5hbnRJZCIsInVzZXJfbWV0YWRhdGEiLCJ0ZW5hbnRfaWQiLCJyZXNwIiwicnBjIiwiX3VzZXJfaWQiLCJpZCIsIl90ZW5hbnRfaWQiLCJlcnIiLCJ3YXJuIiwibWFwIiwicCIsInBlcm1pc3Npb25fa2V5IiwiZ2V0VXNlclBlcm1pc3Npb25zV2l0aEZsYWMiLCJwZXJtcyIsImZsYWMiLCJpbmNsdWRlcyIsImNvbnRhY3RzIiwid3JpdGUiLCJyZWFkIiwiaGFzUGVybWlzc2lvbiIsInBlcm1pc3Npb24iLCJoYXNBbnlQZXJtaXNzaW9uIiwidXNlclBlcm1zIiwic29tZSIsImhhc0FsbFBlcm1pc3Npb25zIiwiZXZlcnkiLCJoYXNSb2xlIiwicm9sZSIsInIiLCJoYXNBbnlSb2xlIiwidXNlclJvbGVzIiwidXIiLCJyZXF1aXJlUGVybWlzc2lvbiIsImFsbG93ZWQiLCJFcnJvciIsInJlcXVpcmVSb2xlIiwiZ3VhcmRBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/rbac/server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminServerClient: () => (/* binding */ createAdminServerClient),\n/* harmony export */   createClient: () => (/* binding */ createClient),\n/* harmony export */   createServerClient: () => (/* binding */ createServerClient),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   getSupabaseServerClient: () => (/* binding */ getSupabaseServerClient),\n/* harmony export */   getUser: () => (/* binding */ getUser)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _supabase_ssr_dist_module_createServerClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr/dist/module/createServerClient */ \"(rsc)/./node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.78.0/node_modules/@supabase/ssr/dist/module/createServerClient.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./lib/logger.ts\");\n\n// Import the specific server subpath to avoid bundling browser client utilities\n\n\n\n/**\r\n * Centralized Supabase server client factory\r\n *\r\n * Features:\r\n * - Singleton pattern for performance\r\n * - Automatic cookie handling\r\n * - Environment variable validation\r\n * - Error logging\r\n *\r\n * Usage:\r\n *   const supabase = await createServerClient()\r\n */ async function createServerClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    const supabaseUrl = \"https://bjykgoucgfdvxteikcho.supabase.co\";\n    const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJqeWtnb3VjZ2Zkdnh0ZWlrY2hvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDIwOTUsImV4cCI6MjA3NTkxODA5NX0.9JxCjKQMP4vwcx4cxYojTeeUUMNup-w6SZTi9bk_zMs\";\n    if (!supabaseUrl || !supabaseAnonKey) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error(\"Supabase environment variables are not configured\", undefined, {\n            hasUrl: !!supabaseUrl,\n            hasKey: !!supabaseAnonKey\n        });\n        throw new Error(\"Supabase environment variables are not configured. Please add NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY to your environment variables.\");\n    }\n    return (0,_supabase_ssr_dist_module_createServerClient__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseAnonKey, {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // The `setAll` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n}\n/**\r\n * Create an admin Supabase server client using the service role key.\r\n * Use this for trusted server-only operations that require elevated privileges\r\n * (for example, creating sessions via a SECURITY DEFINER RPC). This client\r\n * must never be exposed to the browser.\r\n */ function createAdminServerClient() {\n    const supabaseUrl = \"https://bjykgoucgfdvxteikcho.supabase.co\";\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || process.env.SUPABASE_SERVICE_KEY;\n    if (!supabaseUrl || !supabaseServiceKey) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error(\"Supabase service role environment variables are not configured\", undefined, {\n            hasUrl: !!supabaseUrl,\n            hasServiceKey: !!supabaseServiceKey\n        });\n        throw new Error(\"Supabase service role environment variables are not configured. Please add SUPABASE_SERVICE_ROLE_KEY to your environment.\");\n    }\n    // For admin client we don't need cookie handling\n    return (0,_supabase_ssr_dist_module_createServerClient__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseServiceKey, {\n        cookies: {\n            getAll () {\n                return [];\n            },\n            setAll () {\n            // noop - admin client does not set cookies\n            }\n        }\n    });\n}\n/**\r\n * Alias for createServerClient\r\n * @deprecated Use createServerClient instead\r\n */ async function getSupabaseServerClient() {\n    return createServerClient();\n}\n/**\r\n * Alias for createServerClient\r\n * @deprecated Use createServerClient instead\r\n */ async function createClient() {\n    return createServerClient();\n}\n/**\r\n * Get authenticated user from server\r\n */ async function getUser() {\n    const supabase = await createServerClient();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    // If there's an error or no user, attempt a server-side refresh using\n    // the `sb-refresh-token` cookie. This helps when the Supabase access\n    // token has expired but a valid refresh token exists in the browser.\n    if (error || !user) {\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n            // Development fallback remains available\n            if ( true && process.env.DEV_FAKE_USER_ID) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"Using DEV_FAKE_USER fallback for getUser()\");\n                return {\n                    id: process.env.DEV_FAKE_USER_ID,\n                    email: process.env.DEV_FAKE_USER_EMAIL || \"dev@example.com\",\n                    user_metadata: {\n                        full_name: process.env.DEV_FAKE_USER_NAME || \"Local Dev\"\n                    }\n                };\n            }\n            // Try to pick up refresh token from cookies\n            const refreshCookie = cookieStore.get(\"sb-refresh-token\")?.value;\n            const supabaseUrl = \"https://bjykgoucgfdvxteikcho.supabase.co\";\n            const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJqeWtnb3VjZ2Zkdnh0ZWlrY2hvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDIwOTUsImV4cCI6MjA3NTkxODA5NX0.9JxCjKQMP4vwcx4cxYojTeeUUMNup-w6SZTi9bk_zMs\";\n            const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || process.env.SUPABASE_SERVICE_KEY;\n            if (refreshCookie && supabaseUrl && (supabaseAnonKey || supabaseServiceKey)) {\n                // Prefer using the service role key for the Authorization header when available\n                const authHeaderKey = supabaseServiceKey || supabaseAnonKey;\n                try {\n                    const resp = await fetch(`${supabaseUrl.replace(/\\/+$/, \"\")}/auth/v1/token`, {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/x-www-form-urlencoded\",\n                            apikey: supabaseAnonKey || \"\",\n                            Authorization: `Bearer ${authHeaderKey}`\n                        },\n                        body: new URLSearchParams({\n                            grant_type: \"refresh_token\",\n                            refresh_token: refreshCookie\n                        })\n                    });\n                    if (resp.ok) {\n                        const tokenData = await resp.json();\n                        const { access_token, refresh_token, expires_in } = tokenData;\n                        // Set cookies so subsequent requests (and the Supabase SSR client)\n                        // will pick up the refreshed session. We set lightweight cookies\n                        // similar to how the client would set them.\n                        const isProd = \"development\" === \"production\";\n                        try {\n                            cookieStore.set(\"sb-access-token\", access_token, {\n                                httpOnly: false,\n                                path: \"/\",\n                                sameSite: \"lax\",\n                                secure: isProd,\n                                expires: expires_in ? new Date(Date.now() + Number(expires_in) * 1000) : undefined\n                            });\n                            cookieStore.set(\"sb-refresh-token\", refresh_token, {\n                                httpOnly: false,\n                                path: \"/\",\n                                sameSite: \"lax\",\n                                secure: isProd\n                            });\n                        } catch (setErr) {\n                        // ignore cookie set errors (Server Component contexts may not allow set)\n                        }\n                        // Propagate the refreshed session into the Supabase client so\n                        // subsequent auth calls return the correct user object.\n                        try {\n                            await supabase.auth.setSession({\n                                access_token,\n                                refresh_token\n                            });\n                            const { data: { user: refreshedUser }, error: refreshedErr } = await supabase.auth.getUser();\n                            if (!refreshedErr && refreshedUser) return refreshedUser;\n                        } catch (e) {\n                        // fall through to logging below\n                        }\n                    }\n                } catch (e) {\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn(\"Failed to refresh Supabase session via token endpoint: \" + (e?.message || String(e)));\n                }\n            }\n        } catch (e) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn(\"Error while attempting session refresh: \" + (e?.message || String(e)));\n        }\n        if (error) _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error(\"Failed to get user\", error);\n        return null;\n    }\n    return user;\n}\n/**\r\n * Get session from server\r\n */ async function getSession() {\n    const supabase = await createServerClient();\n    const { data: { session }, error } = await supabase.auth.getSession();\n    if (error) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error(\"Failed to get session\", error);\n        return null;\n    }\n    return session;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwic2VydmVyLW9ubHlcIlxyXG4vLyBJbXBvcnQgdGhlIHNwZWNpZmljIHNlcnZlciBzdWJwYXRoIHRvIGF2b2lkIGJ1bmRsaW5nIGJyb3dzZXIgY2xpZW50IHV0aWxpdGllc1xyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgYXMgY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3Nzci9kaXN0L21vZHVsZS9jcmVhdGVTZXJ2ZXJDbGllbnRcIlxyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiXHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJAL2xpYi9sb2dnZXJcIlxyXG5cclxuLyoqXHJcbiAqIENlbnRyYWxpemVkIFN1cGFiYXNlIHNlcnZlciBjbGllbnQgZmFjdG9yeVxyXG4gKlxyXG4gKiBGZWF0dXJlczpcclxuICogLSBTaW5nbGV0b24gcGF0dGVybiBmb3IgcGVyZm9ybWFuY2VcclxuICogLSBBdXRvbWF0aWMgY29va2llIGhhbmRsaW5nXHJcbiAqIC0gRW52aXJvbm1lbnQgdmFyaWFibGUgdmFsaWRhdGlvblxyXG4gKiAtIEVycm9yIGxvZ2dpbmdcclxuICpcclxuICogVXNhZ2U6XHJcbiAqICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNlcnZlckNsaWVudCgpIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxyXG5cclxuICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTFxyXG4gIGNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZXHJcblxyXG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlQW5vbktleSkge1xyXG4gICAgbG9nZ2VyLmVycm9yKFwiU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBub3QgY29uZmlndXJlZFwiLCB1bmRlZmluZWQsIHtcclxuICAgICAgaGFzVXJsOiAhIXN1cGFiYXNlVXJsLFxyXG4gICAgICBoYXNLZXk6ICEhc3VwYWJhc2VBbm9uS2V5LFxyXG4gICAgfSlcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIG5vdCBjb25maWd1cmVkLiBQbGVhc2UgYWRkIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCBhbmQgTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgdG8geW91ciBlbnZpcm9ubWVudCB2YXJpYWJsZXMuXCIsXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICByZXR1cm4gY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSwge1xyXG4gICAgY29va2llczoge1xyXG4gICAgICBnZXRBbGwoKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldEFsbCgpXHJcbiAgICAgIH0sXHJcbiAgICAgIHNldEFsbChjb29raWVzVG9TZXQ6IEFycmF5PHsgbmFtZTogc3RyaW5nOyB2YWx1ZTogc3RyaW5nOyBvcHRpb25zPzogYW55IH0+KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvb2tpZXNUb1NldC5mb3JFYWNoKCh7IG5hbWUsIHZhbHVlLCBvcHRpb25zIH06IHsgbmFtZTogc3RyaW5nOyB2YWx1ZTogc3RyaW5nOyBvcHRpb25zPzogYW55IH0pID0+XHJcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChuYW1lLCB2YWx1ZSwgb3B0aW9ucyksXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAvLyBUaGUgYHNldEFsbGAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXHJcbiAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xyXG4gICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYW4gYWRtaW4gU3VwYWJhc2Ugc2VydmVyIGNsaWVudCB1c2luZyB0aGUgc2VydmljZSByb2xlIGtleS5cclxuICogVXNlIHRoaXMgZm9yIHRydXN0ZWQgc2VydmVyLW9ubHkgb3BlcmF0aW9ucyB0aGF0IHJlcXVpcmUgZWxldmF0ZWQgcHJpdmlsZWdlc1xyXG4gKiAoZm9yIGV4YW1wbGUsIGNyZWF0aW5nIHNlc3Npb25zIHZpYSBhIFNFQ1VSSVRZIERFRklORVIgUlBDKS4gVGhpcyBjbGllbnRcclxuICogbXVzdCBuZXZlciBiZSBleHBvc2VkIHRvIHRoZSBicm93c2VyLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFkbWluU2VydmVyQ2xpZW50KCkge1xyXG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMXHJcbiAgY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSB8fCBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX0tFWVxyXG5cclxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZVNlcnZpY2VLZXkpIHtcclxuICAgIGxvZ2dlci5lcnJvcihcIlN1cGFiYXNlIHNlcnZpY2Ugcm9sZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIG5vdCBjb25maWd1cmVkXCIsIHVuZGVmaW5lZCwge1xyXG4gICAgICBoYXNVcmw6ICEhc3VwYWJhc2VVcmwsXHJcbiAgICAgIGhhc1NlcnZpY2VLZXk6ICEhc3VwYWJhc2VTZXJ2aWNlS2V5LFxyXG4gICAgfSlcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJTdXBhYmFzZSBzZXJ2aWNlIHJvbGUgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBub3QgY29uZmlndXJlZC4gUGxlYXNlIGFkZCBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIHRvIHlvdXIgZW52aXJvbm1lbnQuXCIsXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICAvLyBGb3IgYWRtaW4gY2xpZW50IHdlIGRvbid0IG5lZWQgY29va2llIGhhbmRsaW5nXHJcbiAgcmV0dXJuIGNyZWF0ZVN1cGFiYXNlU2VydmVyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcclxuICAgIGNvb2tpZXM6IHtcclxuICAgICAgZ2V0QWxsKCkge1xyXG4gICAgICAgIHJldHVybiBbXVxyXG4gICAgICB9LFxyXG4gICAgICBzZXRBbGwoKSB7XHJcbiAgICAgICAgLy8gbm9vcCAtIGFkbWluIGNsaWVudCBkb2VzIG5vdCBzZXQgY29va2llc1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQWxpYXMgZm9yIGNyZWF0ZVNlcnZlckNsaWVudFxyXG4gKiBAZGVwcmVjYXRlZCBVc2UgY3JlYXRlU2VydmVyQ2xpZW50IGluc3RlYWRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdXBhYmFzZVNlcnZlckNsaWVudCgpIHtcclxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KClcclxufVxyXG5cclxuLyoqXHJcbiAqIEFsaWFzIGZvciBjcmVhdGVTZXJ2ZXJDbGllbnRcclxuICogQGRlcHJlY2F0ZWQgVXNlIGNyZWF0ZVNlcnZlckNsaWVudCBpbnN0ZWFkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KCkge1xyXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGF1dGhlbnRpY2F0ZWQgdXNlciBmcm9tIHNlcnZlclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXIoKSB7XHJcbiAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG4gIGNvbnN0IHtcclxuICAgIGRhdGE6IHsgdXNlciB9LFxyXG4gICAgZXJyb3IsXHJcbiAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXHJcbiAgLy8gSWYgdGhlcmUncyBhbiBlcnJvciBvciBubyB1c2VyLCBhdHRlbXB0IGEgc2VydmVyLXNpZGUgcmVmcmVzaCB1c2luZ1xyXG4gIC8vIHRoZSBgc2ItcmVmcmVzaC10b2tlbmAgY29va2llLiBUaGlzIGhlbHBzIHdoZW4gdGhlIFN1cGFiYXNlIGFjY2Vzc1xyXG4gIC8vIHRva2VuIGhhcyBleHBpcmVkIGJ1dCBhIHZhbGlkIHJlZnJlc2ggdG9rZW4gZXhpc3RzIGluIHRoZSBicm93c2VyLlxyXG4gIGlmIChlcnJvciB8fCAhdXNlcikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcclxuXHJcbiAgICAgIC8vIERldmVsb3BtZW50IGZhbGxiYWNrIHJlbWFpbnMgYXZhaWxhYmxlXHJcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiICYmIHByb2Nlc3MuZW52LkRFVl9GQUtFX1VTRVJfSUQpIHtcclxuICAgICAgICBsb2dnZXIuaW5mbyhcIlVzaW5nIERFVl9GQUtFX1VTRVIgZmFsbGJhY2sgZm9yIGdldFVzZXIoKVwiKVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpZDogcHJvY2Vzcy5lbnYuREVWX0ZBS0VfVVNFUl9JRCxcclxuICAgICAgICAgIGVtYWlsOiBwcm9jZXNzLmVudi5ERVZfRkFLRV9VU0VSX0VNQUlMIHx8IFwiZGV2QGV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICB1c2VyX21ldGFkYXRhOiB7IGZ1bGxfbmFtZTogcHJvY2Vzcy5lbnYuREVWX0ZBS0VfVVNFUl9OQU1FIHx8IFwiTG9jYWwgRGV2XCIgfSxcclxuICAgICAgICB9IGFzIGFueVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBUcnkgdG8gcGljayB1cCByZWZyZXNoIHRva2VuIGZyb20gY29va2llc1xyXG4gICAgICBjb25zdCByZWZyZXNoQ29va2llID0gY29va2llU3RvcmUuZ2V0KFwic2ItcmVmcmVzaC10b2tlblwiKT8udmFsdWVcclxuICAgICAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkxcclxuICAgICAgY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVlcclxuICAgICAgY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSB8fCBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX0tFWVxyXG5cclxuICAgICAgaWYgKHJlZnJlc2hDb29raWUgJiYgc3VwYWJhc2VVcmwgJiYgKHN1cGFiYXNlQW5vbktleSB8fCBzdXBhYmFzZVNlcnZpY2VLZXkpKSB7XHJcbiAgICAgICAgLy8gUHJlZmVyIHVzaW5nIHRoZSBzZXJ2aWNlIHJvbGUga2V5IGZvciB0aGUgQXV0aG9yaXphdGlvbiBoZWFkZXIgd2hlbiBhdmFpbGFibGVcclxuICAgICAgICBjb25zdCBhdXRoSGVhZGVyS2V5ID0gc3VwYWJhc2VTZXJ2aWNlS2V5IHx8IHN1cGFiYXNlQW5vbktleVxyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKGAke3N1cGFiYXNlVXJsLnJlcGxhY2UoL1xcLyskLywgXCJcIil9L2F1dGgvdjEvdG9rZW5gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxyXG4gICAgICAgICAgICAgIGFwaWtleTogc3VwYWJhc2VBbm9uS2V5IHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2F1dGhIZWFkZXJLZXl9YCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7IGdyYW50X3R5cGU6IFwicmVmcmVzaF90b2tlblwiLCByZWZyZXNoX3Rva2VuOiByZWZyZXNoQ29va2llIGFzIHN0cmluZyB9KSxcclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgaWYgKHJlc3Aub2spIHtcclxuICAgICAgICAgICAgY29uc3QgdG9rZW5EYXRhID0gYXdhaXQgcmVzcC5qc29uKClcclxuICAgICAgICAgICAgY29uc3QgeyBhY2Nlc3NfdG9rZW4sIHJlZnJlc2hfdG9rZW4sIGV4cGlyZXNfaW4gfSA9IHRva2VuRGF0YSBhcyBhbnlcclxuXHJcbiAgICAgICAgICAgIC8vIFNldCBjb29raWVzIHNvIHN1YnNlcXVlbnQgcmVxdWVzdHMgKGFuZCB0aGUgU3VwYWJhc2UgU1NSIGNsaWVudClcclxuICAgICAgICAgICAgLy8gd2lsbCBwaWNrIHVwIHRoZSByZWZyZXNoZWQgc2Vzc2lvbi4gV2Ugc2V0IGxpZ2h0d2VpZ2h0IGNvb2tpZXNcclxuICAgICAgICAgICAgLy8gc2ltaWxhciB0byBob3cgdGhlIGNsaWVudCB3b3VsZCBzZXQgdGhlbS5cclxuICAgICAgICAgICAgY29uc3QgaXNQcm9kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiXHJcblxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChcInNiLWFjY2Vzcy10b2tlblwiLCBhY2Nlc3NfdG9rZW4sIHtcclxuICAgICAgICAgICAgICAgIGh0dHBPbmx5OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiL1wiLFxyXG4gICAgICAgICAgICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXHJcbiAgICAgICAgICAgICAgICBzZWN1cmU6IGlzUHJvZCxcclxuICAgICAgICAgICAgICAgIGV4cGlyZXM6IGV4cGlyZXNfaW4gPyBuZXcgRGF0ZShEYXRlLm5vdygpICsgTnVtYmVyKGV4cGlyZXNfaW4pICogMTAwMCkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KFwic2ItcmVmcmVzaC10b2tlblwiLCByZWZyZXNoX3Rva2VuLCB7XHJcbiAgICAgICAgICAgICAgICBodHRwT25seTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIi9cIixcclxuICAgICAgICAgICAgICAgIHNhbWVTaXRlOiBcImxheFwiLFxyXG4gICAgICAgICAgICAgICAgc2VjdXJlOiBpc1Byb2QsXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSBjYXRjaCAoc2V0RXJyKSB7XHJcbiAgICAgICAgICAgICAgLy8gaWdub3JlIGNvb2tpZSBzZXQgZXJyb3JzIChTZXJ2ZXIgQ29tcG9uZW50IGNvbnRleHRzIG1heSBub3QgYWxsb3cgc2V0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBQcm9wYWdhdGUgdGhlIHJlZnJlc2hlZCBzZXNzaW9uIGludG8gdGhlIFN1cGFiYXNlIGNsaWVudCBzb1xyXG4gICAgICAgICAgICAvLyBzdWJzZXF1ZW50IGF1dGggY2FsbHMgcmV0dXJuIHRoZSBjb3JyZWN0IHVzZXIgb2JqZWN0LlxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2V0U2Vzc2lvbih7IGFjY2Vzc190b2tlbiwgcmVmcmVzaF90b2tlbiB9KVxyXG4gICAgICAgICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgdXNlcjogcmVmcmVzaGVkVXNlciB9LFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IHJlZnJlc2hlZEVycixcclxuICAgICAgICAgICAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcclxuXHJcbiAgICAgICAgICAgICAgaWYgKCFyZWZyZXNoZWRFcnIgJiYgcmVmcmVzaGVkVXNlcikgcmV0dXJuIHJlZnJlc2hlZFVzZXJcclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgIC8vIGZhbGwgdGhyb3VnaCB0byBsb2dnaW5nIGJlbG93XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICBsb2dnZXIud2FybihcIkZhaWxlZCB0byByZWZyZXNoIFN1cGFiYXNlIHNlc3Npb24gdmlhIHRva2VuIGVuZHBvaW50OiBcIiArICgoZSBhcyBhbnkpPy5tZXNzYWdlIHx8IFN0cmluZyhlKSkpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGxvZ2dlci53YXJuKFwiRXJyb3Igd2hpbGUgYXR0ZW1wdGluZyBzZXNzaW9uIHJlZnJlc2g6IFwiICsgKChlIGFzIGFueSk/Lm1lc3NhZ2UgfHwgU3RyaW5nKGUpKSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXJyb3IpIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgdXNlclwiLCBlcnJvcilcclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdXNlclxyXG59XHJcblxyXG4vKipcclxuICogR2V0IHNlc3Npb24gZnJvbSBzZXJ2ZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKCkge1xyXG4gIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICBjb25zdCB7XHJcbiAgICBkYXRhOiB7IHNlc3Npb24gfSxcclxuICAgIGVycm9yLFxyXG4gIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKVxyXG5cclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgc2Vzc2lvblwiLCBlcnJvcilcclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG5cclxuICByZXR1cm4gc2Vzc2lvblxyXG59XHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJjcmVhdGVTdXBhYmFzZVNlcnZlckNsaWVudCIsImNvb2tpZXMiLCJsb2dnZXIiLCJjb29raWVTdG9yZSIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZXJyb3IiLCJ1bmRlZmluZWQiLCJoYXNVcmwiLCJoYXNLZXkiLCJFcnJvciIsImdldEFsbCIsInNldEFsbCIsImNvb2tpZXNUb1NldCIsImZvckVhY2giLCJuYW1lIiwidmFsdWUiLCJvcHRpb25zIiwic2V0IiwiY3JlYXRlQWRtaW5TZXJ2ZXJDbGllbnQiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9LRVkiLCJoYXNTZXJ2aWNlS2V5IiwiZ2V0U3VwYWJhc2VTZXJ2ZXJDbGllbnQiLCJjcmVhdGVDbGllbnQiLCJnZXRVc2VyIiwic3VwYWJhc2UiLCJkYXRhIiwidXNlciIsImF1dGgiLCJERVZfRkFLRV9VU0VSX0lEIiwiaW5mbyIsImlkIiwiZW1haWwiLCJERVZfRkFLRV9VU0VSX0VNQUlMIiwidXNlcl9tZXRhZGF0YSIsImZ1bGxfbmFtZSIsIkRFVl9GQUtFX1VTRVJfTkFNRSIsInJlZnJlc2hDb29raWUiLCJnZXQiLCJhdXRoSGVhZGVyS2V5IiwicmVzcCIsImZldGNoIiwicmVwbGFjZSIsIm1ldGhvZCIsImhlYWRlcnMiLCJhcGlrZXkiLCJBdXRob3JpemF0aW9uIiwiYm9keSIsIlVSTFNlYXJjaFBhcmFtcyIsImdyYW50X3R5cGUiLCJyZWZyZXNoX3Rva2VuIiwib2siLCJ0b2tlbkRhdGEiLCJqc29uIiwiYWNjZXNzX3Rva2VuIiwiZXhwaXJlc19pbiIsImlzUHJvZCIsImh0dHBPbmx5IiwicGF0aCIsInNhbWVTaXRlIiwic2VjdXJlIiwiZXhwaXJlcyIsIkRhdGUiLCJub3ciLCJOdW1iZXIiLCJzZXRFcnIiLCJzZXRTZXNzaW9uIiwicmVmcmVzaGVkVXNlciIsInJlZnJlc2hlZEVyciIsImUiLCJ3YXJuIiwibWVzc2FnZSIsIlN0cmluZyIsImdldFNlc3Npb24iLCJzZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f","vendor-chunks/@opentelemetry+api@1.9.0","vendor-chunks/tr46@0.0.3","vendor-chunks/@supabase+auth-js@2.78.0","vendor-chunks/@supabase+storage-js@2.78.0","vendor-chunks/@supabase+realtime-js@2.78.0","vendor-chunks/@supabase+postgrest-js@2.78.0","vendor-chunks/@supabase+node-fetch@2.6.15","vendor-chunks/whatwg-url@5.0.0","vendor-chunks/tslib@2.8.1","vendor-chunks/@supabase+supabase-js@2.78.0","vendor-chunks/@supabase+functions-js@2.78.0","vendor-chunks/webidl-conversions@3.0.1","vendor-chunks/@supabase+ssr@0.7.0_@supabase+supabase-js@2.78.0","vendor-chunks/cookie@1.0.2"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.18_@babel+core@7._8ad2716156727cb66f6f56422c7b699f/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fpost-login%2Froute&page=%2Fapi%2Fauth%2Fpost-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fpost-login%2Froute.ts&appDir=J%3A%5Cnino360%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=J%3A%5Cnino360&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();